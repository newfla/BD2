\chapter{Analisi}
In questo capitolo sono riportati i risultati e i tempi ottenuti per ogni fase: dalle procedure ETL all'esecuzione delle query.

\section{ETL}
\subsection{Trasformazione in CSV}
In questa sezione copriremo un'analisi dei tempi ottenuti nella fase che permette, a partire dai dati originali, di ottenere un file in formato CSV contenente i dati ripuliti da inconsistenze e in un formato adatto ad essere importato nel Datawarehouse.
In particolare nella fase di puliza, a partire dal file XSLX, si estraggono unicamente i record dove non appaiono valori negativi per quantità intrinsecamente positive (concentrazione, volume, ecc.); per i record ove manca il valore "relative" e/o la distanza percorsa si procede ad un calcolo a partire dall'ultima rilevazione valida estratta. Inoltre tutte le righe che presentano una chiara assenza di dati (70\% delle colonne) vengono scartate. Infine, durante la fase di trasformazione, per ogni file viene generata una data e un test\_id e per separare la parte intera da quella decimale si sostituisce la virgola con il punto.\\
I dati ottenuti si riferiscono ad una media aritmetica ottenuta testando 200 file ($\sim$1 milione di righe) generati a partire dal file originario fornito dall'Istituto Motori di Napoli.

\begin{table}[H]
	\centering
\begin{tabular}{ccccc}
	\rowcolor[HTML]{333333} 
	{\color[HTML]{FFFFFF}Righe XSLX}  
	& 
	{\color[HTML]{FFFFFF}Righe CSV}
	&
	{\color[HTML]{FFFFFF}Righe perse}
	&
	{\color[HTML]{FFFFFF}Peso file XSLX}
	&                                 
	{\color[HTML]{FFFFFF}Peso file CSV}\\
	\begin{tabular}[c]{@{}l@{}}5764\end{tabular}             
	& \begin{tabular}[c]{@{}l@{}}5706\end{tabular} 
	& \begin{tabular}[c]{@{}l@{}}1\%\end{tabular}  
	& \begin{tabular}[c]{@{}l@{}}2.138KB\end{tabular}  
	& \begin{tabular}[c]{@{}l@{}}2.283KB\end{tabular}   
\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\begin{tabular}{ccc}
		\rowcolor[HTML]{333333} 
	{\color[HTML]{FFFFFF}Fase di pulizia}
	&
	{\color[HTML]{FFFFFF}Fase di trasformazione}
	&
	{\color[HTML]{FFFFFF}Tempo totale}\\
	\begin{tabular}[c]{@{}l@{}}3.04s\end{tabular}             
	& \begin{tabular}[c]{@{}l@{}}0,05s\end{tabular} 
	& \begin{tabular}[c]{@{}l@{}}3,05s\end{tabular}
\end{tabular}
\end{table}

Questa fase mette in luce la buona qualità dei dati forniti dall'istituto: ci si aspetta in media di perdere pochissimi dati a causa di inconsistenze. Per quanto riguarda invece le dimensioni si nota come il formato Comma-separated values sia leggermente meno efficiente nella compressione rispetto al formato proprietario di Microsoft$^{\tiny{\textregistered}}$ ma al tempo stesso permetta una più veloce elaborazione.

\subsection{Import in tabella temporanea}
Al fine di importare i file CSV nella tabella dei fatti ci si appoggia ad una tabella temporanea al fine di agevolare le operazioni successive. Questa tabella viene troncata alla fine della procedura. L'import sfrutta la funzione \textit{COPY} messa a disposizione dal DBMS PostgreSQL.

\begin{table}[H]
	\centering
	\begin{tabular}{ccc}
		\rowcolor[HTML]{333333} 
		{\color[HTML]{FFFFFF}Numero file}
		&
		{\color[HTML]{FFFFFF}Numero righe}
		&
		{\color[HTML]{FFFFFF}Tempo}\\
		\begin{tabular}[c]{@{}l@{}}1\end{tabular}             
		& \begin{tabular}[c]{@{}l@{}}5706\end{tabular} 
		& \begin{tabular}[c]{@{}l@{}}214ms\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}50\end{tabular}             
		& \begin{tabular}[c]{@{}l@{}}285.300\end{tabular} 
		& \begin{tabular}[c]{@{}l@{}}8,428s\end{tabular}\\
		\begin{tabular}[c]{@{}l@{}}100\end{tabular}             
		& \begin{tabular}[c]{@{}l@{}}570.600\end{tabular} 
		& \begin{tabular}[c]{@{}l@{}}16.522s\end{tabular}
	\end{tabular}
\caption{I dati si riferiscono ad una media di 5 esecuzioni}
\end{table}	
I risultati mostrano la bontà della funzione \textit{COPY} che sfruttando un inserimento batch di 1000 righe per volta riesce ad abbattere in modo consistente i tempi.

\subsection{Import nello schema}
In questa fase i dati, precedentemente inseriti in una tabella temporanea, vengono travasati nello schema proposto dopo aver disabilitato tutti gli indici. Le prove effettuate prendono in considerazione diverse dimensioni della tabella dei fatti oltre al caso in cui lo schema risulti partizionato.
\begin{table}[H]
	\centering
	\begin{tabular}{cccc}
		\rowcolor[HTML]{333333} 
		{\color[HTML]{FFFFFF}Dimensione tab. fatti}
		&
		{\color[HTML]{FFFFFF}Numero righe importate}
		&
		{\color[HTML]{FFFFFF}Partizionamento}
		&
		{\color[HTML]{FFFFFF}Tempo}\\
		\begin{tabular}[c]{@{}l@{}}0\end{tabular}             
		& \begin{tabular}[c]{@{}l@{}}285.300\end{tabular} 
		& \begin{tabular}[c]{@{}l@{}}No\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}3,925s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}0\end{tabular}             
		& \begin{tabular}[c]{@{}l@{}}285.300\end{tabular} 
		& \begin{tabular}[c]{@{}l@{}}Si\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}7,753s\end{tabular}\\
		\begin{tabular}[c]{@{}l@{}}570.600\end{tabular}             
		& \begin{tabular}[c]{@{}l@{}}285.300\end{tabular} 
		& \begin{tabular}[c]{@{}l@{}}No\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}3,730s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}570.600\end{tabular}             
		& \begin{tabular}[c]{@{}l@{}}285.300\end{tabular} 
		& \begin{tabular}[c]{@{}l@{}}Si\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}7,404s\end{tabular}\\
		\begin{tabular}[c]{@{}l@{}}1.141.200\end{tabular}             
		& \begin{tabular}[c]{@{}l@{}}285.300\end{tabular} 
		& \begin{tabular}[c]{@{}l@{}}No\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}4,535s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}1.141.200\end{tabular}             
		& \begin{tabular}[c]{@{}l@{}}285.300\end{tabular} 
		& \begin{tabular}[c]{@{}l@{}}Si\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}8,572s\end{tabular}
		
	\end{tabular}
	\caption{I dati si riferiscono ad una media di 5 esecuzioni}
\end{table}	
Dalla tabella emerge come il partizionamento comporti quasi un raddoppio del tempo necessario all'inserimento: ciò è dovuto al dover spalmare un singolo record della tabella temporanea su 4 differenti tabelle. Questo slow-down è risolvibile pensando a 4 inserimenti in parallelo: infatti le 4 tabelle, anche se logicamente collegate, durante l'inserimento non necessitano di condividere alcuna informazione.

\subsection{Aggiornamento degli indici}
In questa fase vengono riattivati gli indici delle chiavi tra tabella dei fatti e dimensioni. Questi indici sono assolutamente necessari per velocizzare le query ma possono essere disabilitati durante la fase di update dello schema.
\begin{table}[H]
	\centering
	\begin{tabular}{ccc}
		\rowcolor[HTML]{333333} 
		{\color[HTML]{FFFFFF}Dimensione tab. fatti}
		&
		{\color[HTML]{FFFFFF}Partizionamento}
		&
		{\color[HTML]{FFFFFF}Tempo}\\
		\begin{tabular}[c]{@{}l@{}}285.300\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}No\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}2,530s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}285.300\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}Si\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}11,534s\end{tabular}\\	\begin{tabular}[c]{@{}l@{}}570.600\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}No\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}6,194s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}570.600\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}Si\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}24,715s\end{tabular}\\
		\begin{tabular}[c]{@{}l@{}}1.141.200\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}No\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}16,903s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}1.141.200\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}Si\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}67,469s\end{tabular}\\
		\begin{tabular}[c]{@{}l@{}}1.426.500\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}No\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}24,141s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}1.426.500\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}Si\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}98,218s\end{tabular}
		
	\end{tabular}
	\caption{I dati si riferiscono ad una media di 5 esecuzioni}
\end{table}	
Dai dati sopra mostrati emerge ancora una volta come l'introduzione di un partizionamento verticale comporti un notevole rallentamento. In particolare la forbice tra i tempi registrati aumenta all'aumentare della dimensione dei fatti. Ciò induce a pensare attentamente all'introduzione di un partizionamento in fase di progettazione valutando il rapporto costo/benefici.

\subsection{Aggiornamento delle viste materializzate}
A valle dell'inserimento dei nuovi record si rende necessario l'aggiornamento delle viste materializzate utilizzate per velocizzare le query 3 e 4.
\begin{table}[H]
	\centering
	\begin{tabular}{ccc}
		\rowcolor[HTML]{333333} 
		{\color[HTML]{FFFFFF}Dimensione tab. fatti}
		&
		{\color[HTML]{FFFFFF}Efficiency\_compare\_rpm\_mv}
		&
		{\color[HTML]{FFFFFF}Fuel\_compare\_speed\_mv}\\
		\begin{tabular}[c]{@{}l@{}}285.300\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}0,307s\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}0,238s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}570.600\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}0,983s\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}0,898s\end{tabular}\\
	    \begin{tabular}[c]{@{}l@{}}1.141.200\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}2,464s\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}2,173s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}1.426.500\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}3,004s\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}2,863s\end{tabular}\\
		
	\end{tabular}
	\caption{I dati si riferiscono ad una media di 5 esecuzioni}
\end{table}
I tempi osservati mostrano come un raddoppio del numero di record comporti un più che raddoppio del tempo necessario all'aggiornamento delle viste. Notevole è infatti l'incremento di tempo per materializzare la vista con 1.141.200 record: 2.5 volte quello necessario per materializzare la vista con la metà dei record. 
\section{Analisi Performance Query}
In questa sezione verranno analizzate le query implementate nelle differenti implementazioni e presentati gli snippet di codice SQL

\subsection{Query I}
\subsubsection{Impatto ambientale medio in corse da 5 km}
A seguire sono proposte due diverse formulazioni della stessa interrogazione. Il primo estratto chiede al sistema di recuperare l'appartenenza ad una certa tratta (di 5 km) dalla tabella \textit{distance\_hierarchy}. Nella seconda forma la tratta viene calcolata, eseguendo quindi un'operazione di roll-up implicito.
\subsubsection{Roll-up esplicito}
\begin{lstlisting}[language=mySQL]
SELECT F.test_id, H.km_5, AVG(F.co2_mass_g_s), AVG(F.nox_mass_g_s)
FROM acquisition_fact F INNER JOIN distance_hierarchy H
	ON (F.km_key = H.km_key)
GROUP BY F.test_id, H.km_5
\end{lstlisting}

\subsubsection{Roll-up implicito}
\begin{lstlisting}[language=mySQL]
SELECT F.test_id, FLOOR(F.km_key/5), AVG(F.co2_mass_g_s), AVG(F.nox_mass_g_s)
FROM acquisition_fact F
GROUP BY F.test_id, FLOOR(F.km_key/5)
\end{lstlisting}

\subsubsection{Esito}
L'estrazione dei tempi di esecuzione delle due query può fornire una misura di utilità per una dimensione. In questo caso è interessante notare come un \textit{fatto} possa essere ricondotto alla sua dimensione di appartenenza attraverso un calcolo richiedente 2 operazioni elementari.

\subsection{Query C}
\subsubsection{Consumo medio per intervalli di velocità prefissati}
L'utilizzo della vista materializzata permette di abbattere i tempi di esecuzione della query fino a un trecentesimo: in questo modo il costo di aggiornamento della vista viene immediatamente ammortizzato.
\begin{table}[H]
	\centering
	\begin{tabular}{ccc}
		\rowcolor[HTML]{333333} 
		{\color[HTML]{FFFFFF}Dimensione tab. fatti}
		&
		{\color[HTML]{FFFFFF}Senza vista}
		&
		{\color[HTML]{FFFFFF}Con vista}\\
		\begin{tabular}[c]{@{}l@{}}570.600\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}0,905s\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}0,020\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}1.141.200\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}2,286s\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}0,026s\end{tabular}\\
		\begin{tabular}[c]{@{}l@{}}1.426.500\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}2,925s\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}0.028s\end{tabular}\\
	\end{tabular}
\caption{Test effettuati su schema non partizionato}
\end{table}
\begin{lstlisting}[language=SQL]
SELECT *
FROM fuel_compare_speed_mv;
\end{lstlisting}
\begin{lstlisting}[language=SQL]
SELECT t1.id, t1.fuel_litres as consumo_litri_meno_di_50km_h, t2.fuel_litres as consumo_litri_meno_di_90km_h, t3.fuel_litres as consumo_litri_meno_di_130km_h
FROM
(SELECT test_id as id, round(SUM((fuel_g_s)/1000)::numeric/0.8,2) AS fuel_litres, round(AVG(velocity_km_h)::numeric,1) as average_speed_km_h
FROM acquisition_fact
where speed_km_h <=50
GROUP BY test_id) t1
JOIN (
SELECT test_id as id, round(SUM((fuel_g_s)/1000)::numeric/0.8,2) AS fuel_litres, round(AVG(velocity_km_h)::numeric,1) as average_speed_km_h
FROM acquisition_fact
where speed_km_h >=50 and speed_km_h<=90
GROUP BY test_id
) t2
ON t1.id=t2.id
JOIN (
SELECT test_id as id , round(SUM((fuel_g_s)/1000)::numeric/0.8,2) AS fuel_litres, round(AVG(velocity_km_h)::numeric,1) as average_speed_km_h
FROM acquisition_fact
where speed_km_h >=90
GROUP BY test_id
)t3
ON t1.id=t3.id;
\end{lstlisting}

\subsection{Query E}
\subsubsection{Efficienza dell'auto per intervalli di RPM}
Si conferma quanto osservato nel caso della \textit{query 2}: utilizzare una vista materializzata permette di abbattere i tempi di esecuzione della query e il costo del refresh risulta ampiamente ammortizzato.
\begin{table}[H]
	\centering
	\begin{tabular}{ccc}
		\rowcolor[HTML]{333333} 
		{\color[HTML]{FFFFFF}Dimensione tab. fatti}
		&
		{\color[HTML]{FFFFFF}Senza vista}
		&
		{\color[HTML]{FFFFFF}Con vista}\\
		\begin{tabular}[c]{@{}l@{}}570.600\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}0,937s\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}0,018s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}1.141.200\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}2,182s\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}0,028s\end{tabular}\\
		\begin{tabular}[c]{@{}l@{}}1.426.500\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}2,892s\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}0,030s\end{tabular}\\
		
	\end{tabular}
\caption{Test effettuati su schema non partizionato}
\end{table}
\begin{lstlisting}[language=SQL]
SELECT *
FROM efficiency_compare_rpm_mv;
\end{lstlisting}
\begin{lstlisting}[language=SQL]
SELECT t1.id,  round((t1.rendimento*100)::numeric, 2) as efficiency_perc_max2000rpm, round((t2.rendimento*100)::numeric,2) as efficiency_perc_max3000rpm, round((t3.rendimento*100)::numeric,2) as efficiency_perc_over3000rpm
FROM
(SELECT test_id as id, avg(power_kw)/ (avg(fuel_g_s)/1000 * 458000) as rendimento
FROM acquisition_fact
where engine_RPM_by_ecu_rpm <2000
GROUP BY test_id) t1
JOIN (
SELECT test_id as id, avg(power_kw)/ (avg(fuel_g_s)/1000 * 458000) as rendimento
FROM acquisition_fact
where engine_RPM_by_ecu_rpm >=2000 and engine_RPM_by_ecu_rpm <=3000
GROUP BY test_id
) t2
ON  t1.id=t2.id
JOIN (
SELECT  test_id as id, avg(power_kw)/( avg(fuel_g_s)/1000 * 458000) as rendimento
FROM acquisition_fact
where engine_RPM_by_ecu_rpm >=3000
GROUP BY test_id
)t3
ON t1.id=t3.id;
\end{lstlisting}

\subsection{Query M}
\subsubsection{Per ogni test, media di NOx, CO2, Potenza e Velocità}
Questa interrogazione è stata formulata per analizzare le performance del sistema in condizioni sconvenienti. Più precisamente, si intende osservare il calo di prestazioni dovuto all'overhead necessario alla ricostruzione dell'informazione a partire dalle tabelle partizionate. Si intende quindi operare su 4 colonne distribuite su 2 tabelle ottenute dal partizionamento verticale illustrato nella sezione ~\ref{sec:diagrams}.
\subsubsection{Senza partizionamento}
\begin{lstlisting}[language=SQL]
SELECT F.test_id, AVG(F.co2_mass_g_s), AVG(F.nox_mass_g_s), AVG(F.power_kw), AVG(F.speed_km_h)
FROM acquisition_fact F
GROUP BY F.test_id
\end{lstlisting}

\subsubsection{Con partizionamento}
\begin{lstlisting}[language=SQL]
SELECT F.test_id, AVG(F.co2_mass_g_s), AVG(F.nox_mass_g_s), AVG(F.power_kw), AVG(F.speed_km_h)
FROM acquisition_fact_particles P, acquisition_fact_general G
WHERE P.row_id = G.row_id
GROUP BY F.test_id
\end{lstlisting}

\begin{table}[H]
	\centering
	\begin{tabular}{ccc}
		\rowcolor[HTML]{333333} 
		{\color[HTML]{FFFFFF}Dimensione tab. fatti}
		&
		{\color[HTML]{FFFFFF}Partizionamento}
		&
		{\color[HTML]{FFFFFF}Tempo}\\
		\begin{tabular}[c]{@{}l@{}}570.600\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}No\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}6,194s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}570.600\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}Si\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}24,715s\end{tabular}\\
		\begin{tabular}[c]{@{}l@{}}1.141.200\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}No\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}16,903s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}1.141.200\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}Si\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}67,469s\end{tabular}\\
		\begin{tabular}[c]{@{}l@{}}1.426.500\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}No\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}24,141s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}1.426.500\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}Si\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}98,218s\end{tabular}
		
	\end{tabular}
\end{table}


\subsection{Query T}
\subsubsection{Media e deviazione standard delle temperature}
Inversamente allo scopo della query proposta precedentemente, in questo caso si vuole misurare lo speedup raggiungibile grazie ad un buon partizionamento. Per questo motivo l'interrogazione richiede informazioni di una stessa categoria, memorizzate su di una tabella dedicata alle acquisizioni effettuate dall'Engine Control Unit (ECU).
\subsubsection{Interrogazione sull'intero dataset}
\begin{lstlisting}[language=mySQL]
SELECT F.test_id, AVG(F.engine_coolant_temperature_by_ecu_degc), STDDEV(F.engine_coolant_temperature_by_ecu_degc), AVG(F.ambient_air_temperature_by_ecu_degc), STDDEV(F.ambient_air_temperature_by_ecu_degc), AVG(F.engine_oil_temperature_by_ecu_degc), STDDEV(F.engine_oil_temperature_by_ecu_degc)
FROM acquisition_fact F
GROUP BY F.test_id
\end{lstlisting}
\subsubsection{Interrogazione su tabella ECU}
\begin{lstlisting}[language=mySQL]
SELECT E.test_id, AVG(E.engine_coolant_temperature_by_ecu_degc), STDDEV(E.engine_coolant_temperature_by_ecu_degc), AVG(E.ambient_air_temperature_by_ecu_degc), STDDEV(E.ambient_air_temperature_by_ecu_degc), AVG(E.engine_oil_temperature_by_ecu_degc), STDDEV(E.engine_oil_temperature_by_ecu_degc)
FROM acquisition_fact_ecu E
GROUP BY E.test_id
\end{lstlisting}

\begin{table}[H]
	\centering
	\begin{tabular}{ccc}
		\rowcolor[HTML]{333333} 
		{\color[HTML]{FFFFFF}Dimensione tab. fatti}
		&
		{\color[HTML]{FFFFFF}Partizionamento}
		&
		{\color[HTML]{FFFFFF}Tempo}\\
		\begin{tabular}[c]{@{}l@{}}570.600\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}No\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}6,194s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}570.600\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}Si\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}24,715s\end{tabular}\\
		\begin{tabular}[c]{@{}l@{}}1.141.200\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}No\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}16,903s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}1.141.200\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}Si\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}67,469s\end{tabular}\\
		\begin{tabular}[c]{@{}l@{}}1.426.500\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}No\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}24,141s\end{tabular}\\
		\rowcolor[HTML]{C0C0C0}
		\begin{tabular}[c]{@{}l@{}}1.426.500\end{tabular}              
		& \begin{tabular}[c]{@{}l@{}}Si\end{tabular}
		& \begin{tabular}[c]{@{}l@{}}98,218s\end{tabular}
		
	\end{tabular}
\end{table}	